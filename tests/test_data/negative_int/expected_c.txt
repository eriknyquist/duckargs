// Generated by duckargs, invoked with the following arguments:
// -4 -f --ff -2 -b --blah -2343 -6

#include <getopt.h>
#include <stdlib.h>
#include <stdio.h>

static long int positional_arg0 = -4;
static long int ff = -2;
static long int blah = -2343;
static long int positional_arg1 = -6;

static struct option long_options[] =
{
    {"ff", required_argument, NULL, 'f'},
    {"blah", required_argument, NULL, 'b'},
    {NULL, 0, NULL, 0}
};

void print_usage(void)
{
    printf("\n");
    printf("program_name [OPTIONS] positional_arg0 positional_arg1\n\n");
    printf("-f --ff [int]    An int value (default: %ld)\n", ff);
    printf("-b --blah [int]  An int value (default: %ld)\n", blah);
    printf("\n");
}

int parse_args(int argc, char *argv[])
{
    char *endptr = NULL;
    int ch;

    while ((ch = getopt_long(argc, argv, "f:b:", long_options, NULL)) != -1)
    {
        switch (ch)
        {
            case 'f':
            {
                ff = strtol(optarg, &endptr, 0);
                if (endptr && (*endptr != '\0'))
                {
                    printf("Option '-f' requires an integer argument\n");
                    return -1;
                }
                break;
            }
            case 'b':
            {
                blah = strtol(optarg, &endptr, 0);
                if (endptr && (*endptr != '\0'))
                {
                    printf("Option '-b' requires an integer argument\n");
                    return -1;
                }
                break;
            }
        }
    }

    if (argc < (optind + 2))
    {
        printf("Missing positional arguments\n");
        return -1;
    }

    positional_arg0 = strtol(argv[optind], &endptr, 0);
    if (endptr && (*endptr != '\0'))
    {
        printf("Positional argument #1 (positional_arg0) requires an integer argument\n");
        return -1;
    }
    optind++;

    positional_arg1 = strtol(argv[optind], &endptr, 0);
    if (endptr && (*endptr != '\0'))
    {
        printf("Positional argument #2 (positional_arg1) requires an integer argument\n");
        return -1;
    }
    optind++;

    return 0;
}

int main(int argc, char *argv[])
{
    if (argc < 2)
    {
        print_usage();
        return -1;
    }

    int ret = parse_args(argc, argv);
    if (0 != ret)
    {
        return ret;
    }

    printf("positional_arg0: %ld\n", positional_arg0);
    printf("ff: %ld\n", ff);
    printf("blah: %ld\n", blah);
    printf("positional_arg1: %ld\n", positional_arg1);

    return 0;
}

